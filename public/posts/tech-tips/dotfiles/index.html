<!DOCTYPE html>
<html>
  <head>
    <title>Managing dotfiles with bare git repo</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>
<link rel="stylesheet" href="/css/flag-icon.min.css"/>
<link rel="stylesheet" href="/css/all.min.css">








  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/logolite_hu7e96301cf103bc119b19f5a246bceea0_113023_42x0_resize_box_3.png" />

<meta property="og:title" content="Managing dotfiles with bare git repo" />
<meta property="og:description" content="A tale as old as time: you configure and tweak your personal machine that you use for work, coding, fun and games or whatever and at some point you wonder how you might preserve all those tweaks. Either, you want to back them up (which is always sensible) or you want to transfer to a new machine or want to show them to other people online so they can just download your setup and get going immediately." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bfloeser.netlify.com/posts/tech-tips/dotfiles/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-11T00:00:00+00:00" />



    
    
<meta name="description" content="Managing dotfiles with bare git repo" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    
    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    












<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      </a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/introduction/" title="Introduction">Introduction</a></li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/gaming/">Gaming</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/gaming/gothic2/" title="Gothic 2 on Linux">Gothic 2 on Linux</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/privacy/">Privacy</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/privacy/start/" title="How it started">How it started</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/software/">Software</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/software/os/" title="Operating System">Operating System</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/software/rust/" title="Rust Experiences">Rust Experiences</a></li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="/posts/tech-tips/">Tech Notes</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/tech-tips/conda/" title="conda activate">conda activate</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/tech-tips/dotfiles/" title="Manage dotfiles">Manage dotfiles</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      

      
      <div class="page-content">
        
          
          
          
        

        <div class="title">
          <h1 >Managing dotfiles with bare git repo</h1>
          <p>January 11, 2022</p>
        </div>
        
        <div class="post-content" id="post-content">
          <p>A tale as old as time: you configure and tweak your personal machine that you use for work, coding, fun and games or whatever and at some point you wonder how you might preserve all those tweaks. Either, you want to back them up (which is always sensible) or you want to transfer to a new machine or want to show them to other people online so they can just download your setup and get going immediately.</p>
<p>There are many ways and quite a few dedicated tools to achieve this. You could symlink everything to a central place and use version control to keep track of the files. I have seen people use gnu <code>stow</code> or something like <code>chezmoi</code> or <code>yadm</code> but somehow none of these ever really clicked with me.</p>
<p>I remember having read/heard about using bare git repositories quite a while back but I couldn&rsquo;t make sense of it back then or the tutorials I found were weird, I don&rsquo;t quite remember. Today, however, I once again hazarded a look at the results of my favourite search engine concerning this topic and voilà: I found what I needed.</p>
<p>Disclaimer: none of what I write here is my own idea so I don&rsquo;t take credit or responsibility. With that said, here goes:</p>
<p><code>git init --bare $HOME/.cfg</code></p>
<p>This initializes a bare git repo in a folder called <code>.cfg</code> (name is arbitrary of course), meaning it does not contain a working tree.</p>
<p>Define an alias for using this repo:</p>
<p><code>alias config='/usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME'</code></p>
<p>This should be saved to whatever your shell config file is so you don&rsquo;t have to define this every time you open a terminal. It allows you to perform git commands for the defined repo when outside of it. It also defines the <code>$HOME</code> directory as your working tree and stores the history of it in <code>.cfg</code>.</p>
<p><code>config config --local status.showUntrackedFiles no</code></p>
<p>This changes the local git config so that untracked files are no longer shown. Otherwise every single file in your home folder would pop up here which we clearly are not interested in.</p>
<p>Now the repo can be added to, committed and pushed somewhere:</p>
<ul>
<li>
<p><code>config add .vimrc</code></p>
</li>
<li>
<p><code>config -m &quot;first commit&quot;</code></p>
</li>
<li>
<p><code>config remote add origin &lt;url&gt;</code></p>
</li>
<li>
<p><code>config push -u origin master</code></p>
</li>
</ul>
<p>And done. On a side note: after defining the file completion in bash or zsh don&rsquo;t work anymore. For zsh this can be
changed by simply adding the following line to your <code>.zshrc</code>:</p>
<p><code>setopt complete_aliases</code></p>
<p>For bash <a href="https://wiki.archlinux.org/title/Dotfiles">this Arch wiki entry</a> has some suggestions.</p>
<p>To install the dotfiles on another machine a similar workflow applies.</p>
<p>Clone your repo:</p>
<p><code>git clone --bare &lt;url&gt; $HOME/.cfg</code></p>
<p>Define the alias as above, change config as above so untracked files are not shown.</p>
<p>Checkout to move the files to their destinations:</p>
<p><code>config checkout</code></p>
<p>The last step will throw an error if some of the files already exist. In that case they need to be moved somewhere else or deleted. If you&rsquo;re sure, you don&rsquo;t need any of the already present files, you can force the checkout:</p>
<p><code>config checkout -f</code></p>

        </div>

        
        

        
      <hr />
        







  





  
  

  
  

  
  

  
  

  
  

  
  

  
    
    
  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/tech-tips/conda/" title="Running a script on conda activate" class="btn btn-outline-info">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Running a script on conda activate</div>
      </a>
    </div>
  
  
</div>

      <hr />
      
      
      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    
    









  
      
  



  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hossainemruz/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">© 2020 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
